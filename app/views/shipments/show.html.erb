<%= stylesheet_link_tag 'shipment_details', media: 'all', 'data-turbolinks-track': 'reload' %>

<a href="<%= destroy_user_session_path %>" data-method="delete" class="logout-link">Logout</a>

<div class="container">
  <h1>ðŸ“± Shipment Details</h1>
  <table>
    <tbody>
      <tr>
        <th>Shipment ID</th>
        <td><%= @shipment.id %></td>
      </tr>
      <tr>
        <th>Source</th>
        <td><%= @shipment.source %></td>
      </tr>
      <tr>
        <th>Destination</th>
        <td><%= @shipment.target %></td>
      </tr>
      <tr>
        <th>Item Details</th>
        <td><%= @shipment.item_details %></td>
      </tr>
      <tr>
        <th>Status</th>
        <td><%= Shipment::STATUS_VALUES.key(@shipment.status).to_s.humanize rescue @shipment.status.to_s.humanize %></td>
      </tr>
    </tbody>
  </table>

  <%= link_to "Back to Shipments", shipments_path, class: "btn btn-secondary" %>

  <% if current_user.delivery_partner? && @shipment.status == Shipment::STATUS_VALUES["pending"] %>
    <%= button_to accept_delivery_shipment_path(@shipment), method: :post, class: "btn btn-success ml-2" do %>
      Accept Delivery
    <% end %>
  <% end %>

  <% if current_user.delivery_partner? %>
    <h3>Update Shipment Status</h3>
    <%= form_with(model: @shipment, url: shipment_path(@shipment), method: :patch, local: true) do |f| %>
      <div>
        <%= f.label :status, "Status" %><br />
        <%= f.select :status, Shipment::STATUS_VALUES.map { |k, v| [k.humanize, v] }, selected: @shipment.status %>
      </div>
      <div>
        <%= f.submit "Update Status", class: "btn btn-primary mt-2" %>
      </div>
    <% end %>
  <% end %>
</div>
